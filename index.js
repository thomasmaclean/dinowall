(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
/**
 * Copyright 2016 Google Inc. All Rights Reserved.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/license-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the license.
 */

'use strict';

module.exports = require('./lib/anypixel');

},{"./lib/anypixel":2}],2:[function(require,module,exports){
/**
 * Copyright 2016 Google Inc. All Rights Reserved.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/license-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the license.
 */

'use strict';

module.exports.config = require('./config');
module.exports.canvas = require('./canvas');
module.exports.events = require('./events');
module.exports.events.setStateListenerOn(document);

},{"./canvas":3,"./config":4,"./events":5}],3:[function(require,module,exports){
/**
 * Copyright 2016 Google Inc. All Rights Reserved.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/license-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the license.
 */

'use strict';

var config = require('./config');
var canvas = module.exports = {};

var domCanvas = document.getElementById(config.canvasId);

domCanvas.width = config.width;
domCanvas.height = config.height;

/**
 * Returns the 2D canvas context
 */
canvas.getContext2D = function getContext2D() {
	return domCanvas.getContext('2d');
}

/**
 * Returns the 3D canvas context
 */
canvas.getContext3D = function getContext3D() {
	return domCanvas.getContext('webgl', {preserveDrawingBuffer: true});
}
},{"./config":4}],4:[function(require,module,exports){
/**
 * Copyright 2016 Google Inc. All Rights Reserved.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/license-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the license.
 */

'use strict';

/**
 * Expose some configuration data. The user can overwrite this if their setup is different.
 */
var config = module.exports = {};

config.canvasId = 'button-canvas';
config.width = 140;
config.height = 42;
},{}],5:[function(require,module,exports){
/**
 * Copyright 2016 Google Inc. All Rights Reserved.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/license-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the license.
 */

'use strict';

/**
 * Listen for the 'buttonStates' event from a DOM target and emit onButtonDown / Up events
 * depending on the reported button state
 */
var events = module.exports = {};

events.setStateListenerOn = function setStateListenerOn(target) {
		
	if (target.anypixelListener) {
		return;
	}
	
	target.anypixelListener = true;

	target.addEventListener('buttonStates', function(data) {
		data.detail.forEach(function(button) {
			var x = button.p.x;
			var y = button.p.y;
			var state = button.s;
			var event = state === 1 ? 'onButtonDown' : 'onButtonUp';
			var key = x + ':' + y;

			if (state === 1) {
				events.pushedButtons[key] = {x: x, y: y};
			} else {
				delete events.pushedButtons[key];
			}
			
			target.dispatchEvent(new CustomEvent(event, {detail: {x: x, y: y}}));
		});
	});
}

/**
 * A map of currently-pushed buttons, provided for utility
 */
events.pushedButtons = {};

},{}],6:[function(require,module,exports){
/**
 * Copyright 2016 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/license-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the license.
 */

var anypixel = require('anypixel');
var ctx = anypixel.canvas.getContext2D();
const ObstacleManager = require('./obstacle_manager');
const Obstacle = require('./obstacle');

const INC_W = anypixel.config.width;
const INC_H = anypixel.config.height;

const HORIZON_W = 1200;
const HORIZON_H = 12;
const HORIZON_HILL_H = 4;
const HORIZON_SPEED = 4;
let horizonLocation = 0;
const horizonImageDataUri = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABLAAAAASCAYAAABLuic5AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wwJFRcnXpgxYQAAAYVJREFUeNrt3FGuwiAQBVBZY/e/FvzSGEMTCrR06DmfxjyfUxguFk0vAADgdDnnXHo8pZRUB9AD9VgAAIDpG7fS5mrvcYCn9MAIf5978EkkAACcuGn7Bu+dUwCf5zglAOiBeiwAAMDlG7cjd/+dxgL0wLrnt/RLPTa+5AICAMBJYfvgHf+R2bzmte0FgKg9sPfEFgAAAJPVnDRwGgGASHwHFAAAFlTz4ZTfhAEgiqUXrJofdOO60OQaGKuYJ2DeWbMwfo1VzBMw74a/+C+Xo/3C9dRfNePWb9u2HHkMGitr9ZRSb1/9mj5hHkR/r///d+t7iVQH+Uq+smbGzTjGjnwlX8lX8hWAkKQeQiwTx7+AAuin6oF8ZfzLVwRtrKMHWuQ7rivdQdFE2urZWzN1R3DEJk1N5Cv5ypyTr0C+kiWmLPx3GViO4teZ+XU2WHlx1Xeu69/6mEAZKaDJV8YFIF9F6N9qLV9ZRwEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIDx3klPSzP33sjKAAAAAElFTkSuQmCC';

const FLOOR_HEIGHT = INC_H - HORIZON_H + HORIZON_HILL_H;

var colors = ['#F00', '#0F0', '#00F'];

const DINOSAUR_H = 22;
const DINOSAUR_W = 20;
const dinosaur = {
  x: 0,
  y: FLOOR_HEIGHT - DINOSAUR_H,
};

const dinoImageDataUri = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAL0AAAAWCAYAAACVDJ0dAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wwJFR4dSVZTmgAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAKKSURBVHja7VvBbsMgDLWjHPJVPZJvhmO/qjd26CIxCsE2OE0WW0LaFHgG+9mA2dB7Dy1xzm0/xkZXDCEAVQxXF3eTdV13cb33CDeSidE3UvokDjRcJi4iwtZG4a7rGmOMsDVJUNyZ9O9Ug9dKClrz1cKtEfOs870F6bWcoiVa870aOa/mN02ZzQT/P0Aty3dmehOTu2d6rRRiuCZ6pH88HgAA8Hw+ix0a1YJ0P/5TTtvG1UpshkvChRruKLlbuRIAYF6WJb5eL2w4I3Ky2+/YWOpjuP24AO8yY4uwpVLk3ph0Tj0BRg3kEMIwnRy9c2NwpE6eOSnDVcDdIzvnPg0AmO9QCu8ZmNlhhE6S3hkAYFmW6JxD5uBIyEiGq4hbyvYtwm/fG7tELBCTRChGMOc7oFQnW+9UAeco4kSe4Q7GTUlOyfDMM3zMGrX/ewGyUilXJ1vvzMw+IxxuuINxuceZBvFRMM/yYunvDsN0UvR2lSw1qgmGq49LuFgOJeHZdE4gqzHvls9+vxmuEq7gmEIek+jFI4PtSJ1Th2MoCzFcJVwp8b9IQiy0I4j/oXcSOAaVHG64AqdTic8NkA4SYmXMx+U03806iU/WOzEdg9yzpuHq4lIILd0RiCRMyYbZWmutusYQAsVW2KN3JtykR10wjsRNIxydc5JLYYrLqQN/xQ7ee0yrOPnvEskfjwo2wOxVtcfeJb2w59csm5P1To1qAeZRJ1nMF3CBklUYGe7joehMdqhl9t4zfzaX2Lhsi+1NtVOWycV6554KgjTTaeOOwM9KaR9/J3JWOyhdbnFv7sqlVWwEBL96s/Ot9P+YcYDjj8TtJn6SYS5hh9KRpueYU7HBcFvv2Wk04A8GVyP3KvY3jQAAAABJRU5ErkJggg==';

let lastFrame = Date.now();
const horizonImage = getHorizonImage();
const dinosaurImage = getDinosaurImage();

const obstacleManager = new ObstacleManager();

/**
 * Listen for onButtonDown events and draw a 2x2 rectangle at the event site
 */
document.addEventListener('onButtonDown', function (event) {
  obstacleManager.addDefaultObstacle(new Obstacle(event.detail.x - horizonLocation, event.detail.y));
});

document.addEventListener('DOMContentLoaded', () => {
  requestAnimationFrame(update);
});

function drawHorizon(elapsedTimeInFrame) {
  updateHorizonLocation(elapsedTimeInFrame);
  ctx.drawImage(horizonImage, horizonLocation, INC_H - horizonImage.height);
  ctx.drawImage(horizonImage, horizonLocation + horizonImage.width,
      INC_H - horizonImage.height);
}

function updateHorizonLocation(elapsedTimeInFrame) {
  horizonLocation -= elapsedTimeInFrame * HORIZON_SPEED;
  horizonLocation = Math.floor(horizonLocation) % HORIZON_W;
}

function drawDinosaur(dinosaur) {
  ctx.drawImage(dinosaurImage, 0, 0, DINOSAUR_W, DINOSAUR_H,
      dinosaur.x, dinosaur.y, DINOSAUR_W, DINOSAUR_H);
}

function drawObstacles(obstacleManager){
  ctx.fillStyle = colors[1];
  for(obstacle of obstacleManager.getDefaultObstacles()){
    ctx.fillRect(obstacle.x + horizonLocation, obstacle.y, obstacle.width, obstacle.height);
  }
}

function update() {
  ctx.fillStyle = '#000';
  ctx.fillRect(0, 0, INC_W, INC_H);

  const elapsedTimeInFrame = (Date.now() - lastFrame) / 1000;
  drawHorizon(elapsedTimeInFrame);
  drawDinosaur(dinosaur);
  drawObstacles(obstacleManager);
  lastFrame = Date.now();

  requestAnimationFrame(update);
}

function getHorizonImage() {
  const horizonImage = new Image;
  horizonImage.src = horizonImageDataUri;
  horizonImage.height = HORIZON_H;
  horizonImage.width = HORIZON_W;
  return horizonImage;
}

function getDinosaurImage() {
  const dinoImage = new Image;
  dinoImage.src = dinoImageDataUri;
  return dinoImage;
}


},{"./obstacle":7,"./obstacle_manager":8,"anypixel":1}],7:[function(require,module,exports){
module.exports =  class Obstacle {
  constructor(x, y, width = 2, height = 4) {
    this.x = x;
    this.y = y;
    this.width = width;
    this.height = height;
  }
}

},{}],8:[function(require,module,exports){
const Obstacle = require('./obstacle');

module.exports =  class ObstacleManager{
  defaultObstacles = [];

  constructor(){
  }

  addDefaultObstacle(obstacle){
    this.defaultObstacles.push(obstacle);
  }

  getDefaultObstacles(){
    return this.defaultObstacles;
  }
}

},{"./obstacle":7}]},{},[6])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Vzci9sb2NhbC9saWIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIm5vZGVfbW9kdWxlcy9hbnlwaXhlbC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9hbnlwaXhlbC9saWIvYW55cGl4ZWwuanMiLCJub2RlX21vZHVsZXMvYW55cGl4ZWwvbGliL2NhbnZhcy5qcyIsIm5vZGVfbW9kdWxlcy9hbnlwaXhlbC9saWIvY29uZmlnLmpzIiwibm9kZV9tb2R1bGVzL2FueXBpeGVsL2xpYi9ldmVudHMuanMiLCJzcmMvYXBwLmpzIiwic3JjL29ic3RhY2xlLmpzIiwic3JjL29ic3RhY2xlX21hbmFnZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9saWNlbnNlLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIGxpY2Vuc2UuXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vbGliL2FueXBpeGVsJyk7XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IEdvb2dsZSBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL2xpY2Vuc2UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgbGljZW5zZS5cbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzLmNvbmZpZyA9IHJlcXVpcmUoJy4vY29uZmlnJyk7XG5tb2R1bGUuZXhwb3J0cy5jYW52YXMgPSByZXF1aXJlKCcuL2NhbnZhcycpO1xubW9kdWxlLmV4cG9ydHMuZXZlbnRzID0gcmVxdWlyZSgnLi9ldmVudHMnKTtcbm1vZHVsZS5leHBvcnRzLmV2ZW50cy5zZXRTdGF0ZUxpc3RlbmVyT24oZG9jdW1lbnQpO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9saWNlbnNlLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIGxpY2Vuc2UuXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgY29uZmlnID0gcmVxdWlyZSgnLi9jb25maWcnKTtcbnZhciBjYW52YXMgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG52YXIgZG9tQ2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29uZmlnLmNhbnZhc0lkKTtcblxuZG9tQ2FudmFzLndpZHRoID0gY29uZmlnLndpZHRoO1xuZG9tQ2FudmFzLmhlaWdodCA9IGNvbmZpZy5oZWlnaHQ7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgMkQgY2FudmFzIGNvbnRleHRcbiAqL1xuY2FudmFzLmdldENvbnRleHQyRCA9IGZ1bmN0aW9uIGdldENvbnRleHQyRCgpIHtcblx0cmV0dXJuIGRvbUNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIDNEIGNhbnZhcyBjb250ZXh0XG4gKi9cbmNhbnZhcy5nZXRDb250ZXh0M0QgPSBmdW5jdGlvbiBnZXRDb250ZXh0M0QoKSB7XG5cdHJldHVybiBkb21DYW52YXMuZ2V0Q29udGV4dCgnd2ViZ2wnLCB7cHJlc2VydmVEcmF3aW5nQnVmZmVyOiB0cnVlfSk7XG59IiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9saWNlbnNlLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIGxpY2Vuc2UuXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIEV4cG9zZSBzb21lIGNvbmZpZ3VyYXRpb24gZGF0YS4gVGhlIHVzZXIgY2FuIG92ZXJ3cml0ZSB0aGlzIGlmIHRoZWlyIHNldHVwIGlzIGRpZmZlcmVudC5cbiAqL1xudmFyIGNvbmZpZyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbmNvbmZpZy5jYW52YXNJZCA9ICdidXR0b24tY2FudmFzJztcbmNvbmZpZy53aWR0aCA9IDE0MDtcbmNvbmZpZy5oZWlnaHQgPSA0MjsiLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IEdvb2dsZSBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL2xpY2Vuc2UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgbGljZW5zZS5cbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbi8qKlxuICogTGlzdGVuIGZvciB0aGUgJ2J1dHRvblN0YXRlcycgZXZlbnQgZnJvbSBhIERPTSB0YXJnZXQgYW5kIGVtaXQgb25CdXR0b25Eb3duIC8gVXAgZXZlbnRzXG4gKiBkZXBlbmRpbmcgb24gdGhlIHJlcG9ydGVkIGJ1dHRvbiBzdGF0ZVxuICovXG52YXIgZXZlbnRzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuZXZlbnRzLnNldFN0YXRlTGlzdGVuZXJPbiA9IGZ1bmN0aW9uIHNldFN0YXRlTGlzdGVuZXJPbih0YXJnZXQpIHtcblx0XHRcblx0aWYgKHRhcmdldC5hbnlwaXhlbExpc3RlbmVyKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdFxuXHR0YXJnZXQuYW55cGl4ZWxMaXN0ZW5lciA9IHRydWU7XG5cblx0dGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2J1dHRvblN0YXRlcycsIGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRkYXRhLmRldGFpbC5mb3JFYWNoKGZ1bmN0aW9uKGJ1dHRvbikge1xuXHRcdFx0dmFyIHggPSBidXR0b24ucC54O1xuXHRcdFx0dmFyIHkgPSBidXR0b24ucC55O1xuXHRcdFx0dmFyIHN0YXRlID0gYnV0dG9uLnM7XG5cdFx0XHR2YXIgZXZlbnQgPSBzdGF0ZSA9PT0gMSA/ICdvbkJ1dHRvbkRvd24nIDogJ29uQnV0dG9uVXAnO1xuXHRcdFx0dmFyIGtleSA9IHggKyAnOicgKyB5O1xuXG5cdFx0XHRpZiAoc3RhdGUgPT09IDEpIHtcblx0XHRcdFx0ZXZlbnRzLnB1c2hlZEJ1dHRvbnNba2V5XSA9IHt4OiB4LCB5OiB5fTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGRlbGV0ZSBldmVudHMucHVzaGVkQnV0dG9uc1trZXldO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0YXJnZXQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoZXZlbnQsIHtkZXRhaWw6IHt4OiB4LCB5OiB5fX0pKTtcblx0XHR9KTtcblx0fSk7XG59XG5cbi8qKlxuICogQSBtYXAgb2YgY3VycmVudGx5LXB1c2hlZCBidXR0b25zLCBwcm92aWRlZCBmb3IgdXRpbGl0eVxuICovXG5ldmVudHMucHVzaGVkQnV0dG9ucyA9IHt9O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL2xpY2Vuc2UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgbGljZW5zZS5cbiAqL1xuXG52YXIgYW55cGl4ZWwgPSByZXF1aXJlKCdhbnlwaXhlbCcpO1xudmFyIGN0eCA9IGFueXBpeGVsLmNhbnZhcy5nZXRDb250ZXh0MkQoKTtcbmNvbnN0IE9ic3RhY2xlTWFuYWdlciA9IHJlcXVpcmUoJy4vb2JzdGFjbGVfbWFuYWdlcicpO1xuY29uc3QgT2JzdGFjbGUgPSByZXF1aXJlKCcuL29ic3RhY2xlJyk7XG5cbmNvbnN0IElOQ19XID0gYW55cGl4ZWwuY29uZmlnLndpZHRoO1xuY29uc3QgSU5DX0ggPSBhbnlwaXhlbC5jb25maWcuaGVpZ2h0O1xuXG5jb25zdCBIT1JJWk9OX1cgPSAxMjAwO1xuY29uc3QgSE9SSVpPTl9IID0gMTI7XG5jb25zdCBIT1JJWk9OX0hJTExfSCA9IDQ7XG5jb25zdCBIT1JJWk9OX1NQRUVEID0gNDtcbmxldCBob3Jpem9uTG9jYXRpb24gPSAwO1xuY29uc3QgaG9yaXpvbkltYWdlRGF0YVVyaSA9ICdkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQkxBQUFBQVNDQVlBQUFCTHVpYzVBQUFBQm1KTFIwUUEvd0QvQVArZ3ZhZVRBQUFBQ1hCSVdYTUFBQzRqQUFBdUl3RjRwVDkyQUFBQUIzUkpUVVVINHd3SkZSY25YcGd4WVFBQUFZVkpSRUZVZU5ydDNGR3V3aUFRQlZCWlkvZS9GdnpTR0VNVENyUjA2RG1meGp5ZlV4Z3VGazB2QUFEZ2REbm5YSG84cFpSVUI5QUQ5VmdBQUlEcEc3ZlM1bXJ2Y1lDbjlNQUlmNTk3OEVra0FBQ2N1R243QnUrZFV3Q2Y1emdsQU9pQmVpd0FBTURsRzdjamQvK2R4Z0wwd0xybnQvUkxQVGErNUFJQ0FNQkpZZnZnSGYrUjJiem10ZTBGZ0tnOXNQZkVGZ0FBQUpQVm5EUndHZ0dBU0h3SEZBQUFGbFR6NFpUZmhBRWdpcVVYckpvZmRPTzYwT1FhR0t1WUoyRGVXYk13Zm8xVnpCTXc3NGEvK0MrWG8vM0M5ZFJmTmVQV2I5dTJISGtNR2l0cjlaUlNiMS85bWo1aEhrUi9yLy8vZCt0N2lWUUgrVXErc21iR3pUakdqbndsWDhsWDhoV0FrS1FlUWl3VHg3K0FBdWluNm9GOFpmekxWd1J0cktNSFd1UTdyaXZkUWRGRTJ1clpXek4xUjNERUprMU41Q3Y1eXB5VHIwQytraVdtTFB4M0dWaU80dGVaK1hVMldIbHgxWGV1NjkvNm1FQVpLYURKVjhZRklGOUY2TjlxTFY5WlJ3RUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFJRHgza2xQU3pQMzNzaktBQUFBQUVsRlRrU3VRbUNDJztcblxuY29uc3QgRkxPT1JfSEVJR0hUID0gSU5DX0ggLSBIT1JJWk9OX0ggKyBIT1JJWk9OX0hJTExfSDtcblxudmFyIGNvbG9ycyA9IFsnI0YwMCcsICcjMEYwJywgJyMwMEYnXTtcblxuY29uc3QgRElOT1NBVVJfSCA9IDIyO1xuY29uc3QgRElOT1NBVVJfVyA9IDIwO1xuY29uc3QgZGlub3NhdXIgPSB7XG4gIHg6IDAsXG4gIHk6IEZMT09SX0hFSUdIVCAtIERJTk9TQVVSX0gsXG59O1xuXG5jb25zdCBkaW5vSW1hZ2VEYXRhVXJpID0gJ2RhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBTDBBQUFBV0NBWUFBQUNWREowZEFBQUFCbUpMUjBRQUFBQUFBQUQ1UTd0L0FBQUFDWEJJV1hNQUFDNGpBQUF1SXdGNHBUOTJBQUFBQjNSSlRVVUg0d3dKRlI0ZFNWWlRtZ0FBQUJsMFJWaDBRMjl0YldWdWRBQkRjbVZoZEdWa0lIZHBkR2dnUjBsTlVGZUJEaGNBQUFLS1NVUkJWSGphN1Z2QmJzTWdETFdqSFBKVlBaSnZobU8vcWpkMjZDSXhDc0UyT0UwV1cwTGFGSGdHKzltQTJkQjdEeTF4em0wL3hrWlhEQ0VBVlF4WEYzZVRkVjEzY2IzM0NEZVNpZEUzVXZva0RqUmNKaTRpd3RaRzRhN3JHbU9Nc0RWSlVOeVo5TzlVZzlkS0NscnoxY0t0RWZPczg3MEY2Yldjb2lWYTg3MGFPYS9tTjAyWnpRVC9QMEF0eTNkbWVoT1R1MmQ2clJSaXVDWjZwSDg4SGdBQThIdytpeDBhMVlKMFAvNVRUdHZHMVVwc2hrdkNoUnJ1S0xsYnVSSUFZRjZXSmI1ZUwydzRJM0t5MisvWVdPcGp1UDI0QU84eVk0dXdwVkxrM3BoMFRqMEJSZzNrRU1Jd25SeTljMk53cEU2ZU9TbkRWY0RkSXp2blBnMEFtTzlRQ3U4Wm1ObGhoRTZTM2hrQVlGbVc2SnhENXVCSXlFaUdxNGhieXZZdHdtL2ZHN3RFTEJDVFJDaEdNT2M3b0ZRblcrOVVBZWNvNGtTZTRRN0dUVWxPeWZETU0zek1HclgvZXdHeVVpbFhKMXZ2ek13K0l4eHV1SU54dWNlWkJ2RlJNTS95WXVudkRzTjBVdlIybFN3MXFnbUdxNDlMdUZnT0plSFpkRTRncXpIdmxzOSt2eG11RXE3Z21FSWVrK2pGSTRQdFNKMVRoMk1vQ3pGY0pWd3A4YjlJUWl5MEk0ai9vWGNTT0FhVkhHNjRBcWRUaWM4TmtBNFNZbVhNeCtVMDM4MDZpVS9XT3pFZGc5eXpwdUhxNGxJSUxkMFJpQ1JNeVliWldtdXR1c1lRQXNWVzJLTjNKdHlrUjEwd2pzUk5JeHlkYzVKTFlZckxxUU4veFE3ZWUweXJPUG52RXNrZmp3bzJ3T3hWdGNmZUpiMnc1OWNzbTVQMVRvMXFBZVpSSjFuTUYzQ0JrbFVZR2U3am9laE1kcWhsOXQ0emZ6YVgyTGhzaSsxTnRWT1d5Y1Y2NTU0S2dqVFRhZU9Pd005S2FSOS9KM0pXT3loZGJuRnY3c3FsVld3RUJMOTZzL090OVArWWNZRGpqOFR0Sm42U1lTNWhoOUtScHVlWVU3SEJjRnZ2MldrMDRBOEdWeVAzS3ZZM2pRQUFBQUJKUlU1RXJrSmdnZz09JztcblxubGV0IGxhc3RGcmFtZSA9IERhdGUubm93KCk7XG5jb25zdCBob3Jpem9uSW1hZ2UgPSBnZXRIb3Jpem9uSW1hZ2UoKTtcbmNvbnN0IGRpbm9zYXVySW1hZ2UgPSBnZXREaW5vc2F1ckltYWdlKCk7XG5cbmNvbnN0IG9ic3RhY2xlTWFuYWdlciA9IG5ldyBPYnN0YWNsZU1hbmFnZXIoKTtcblxuLyoqXG4gKiBMaXN0ZW4gZm9yIG9uQnV0dG9uRG93biBldmVudHMgYW5kIGRyYXcgYSAyeDIgcmVjdGFuZ2xlIGF0IHRoZSBldmVudCBzaXRlXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ29uQnV0dG9uRG93bicsIGZ1bmN0aW9uIChldmVudCkge1xuICBvYnN0YWNsZU1hbmFnZXIuYWRkRGVmYXVsdE9ic3RhY2xlKG5ldyBPYnN0YWNsZShldmVudC5kZXRhaWwueCAtIGhvcml6b25Mb2NhdGlvbiwgZXZlbnQuZGV0YWlsLnkpKTtcbn0pO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlKTtcbn0pO1xuXG5mdW5jdGlvbiBkcmF3SG9yaXpvbihlbGFwc2VkVGltZUluRnJhbWUpIHtcbiAgdXBkYXRlSG9yaXpvbkxvY2F0aW9uKGVsYXBzZWRUaW1lSW5GcmFtZSk7XG4gIGN0eC5kcmF3SW1hZ2UoaG9yaXpvbkltYWdlLCBob3Jpem9uTG9jYXRpb24sIElOQ19IIC0gaG9yaXpvbkltYWdlLmhlaWdodCk7XG4gIGN0eC5kcmF3SW1hZ2UoaG9yaXpvbkltYWdlLCBob3Jpem9uTG9jYXRpb24gKyBob3Jpem9uSW1hZ2Uud2lkdGgsXG4gICAgICBJTkNfSCAtIGhvcml6b25JbWFnZS5oZWlnaHQpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVIb3Jpem9uTG9jYXRpb24oZWxhcHNlZFRpbWVJbkZyYW1lKSB7XG4gIGhvcml6b25Mb2NhdGlvbiAtPSBlbGFwc2VkVGltZUluRnJhbWUgKiBIT1JJWk9OX1NQRUVEO1xuICBob3Jpem9uTG9jYXRpb24gPSBNYXRoLmZsb29yKGhvcml6b25Mb2NhdGlvbikgJSBIT1JJWk9OX1c7XG59XG5cbmZ1bmN0aW9uIGRyYXdEaW5vc2F1cihkaW5vc2F1cikge1xuICBjdHguZHJhd0ltYWdlKGRpbm9zYXVySW1hZ2UsIDAsIDAsIERJTk9TQVVSX1csIERJTk9TQVVSX0gsXG4gICAgICBkaW5vc2F1ci54LCBkaW5vc2F1ci55LCBESU5PU0FVUl9XLCBESU5PU0FVUl9IKTtcbn1cblxuZnVuY3Rpb24gZHJhd09ic3RhY2xlcyhvYnN0YWNsZU1hbmFnZXIpe1xuICBjdHguZmlsbFN0eWxlID0gY29sb3JzWzFdO1xuICBmb3Iob2JzdGFjbGUgb2Ygb2JzdGFjbGVNYW5hZ2VyLmdldERlZmF1bHRPYnN0YWNsZXMoKSl7XG4gICAgY3R4LmZpbGxSZWN0KG9ic3RhY2xlLnggKyBob3Jpem9uTG9jYXRpb24sIG9ic3RhY2xlLnksIG9ic3RhY2xlLndpZHRoLCBvYnN0YWNsZS5oZWlnaHQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgY3R4LmZpbGxTdHlsZSA9ICcjMDAwJztcbiAgY3R4LmZpbGxSZWN0KDAsIDAsIElOQ19XLCBJTkNfSCk7XG5cbiAgY29uc3QgZWxhcHNlZFRpbWVJbkZyYW1lID0gKERhdGUubm93KCkgLSBsYXN0RnJhbWUpIC8gMTAwMDtcbiAgZHJhd0hvcml6b24oZWxhcHNlZFRpbWVJbkZyYW1lKTtcbiAgZHJhd0Rpbm9zYXVyKGRpbm9zYXVyKTtcbiAgZHJhd09ic3RhY2xlcyhvYnN0YWNsZU1hbmFnZXIpO1xuICBsYXN0RnJhbWUgPSBEYXRlLm5vdygpO1xuXG4gIHJlcXVlc3RBbmltYXRpb25GcmFtZSh1cGRhdGUpO1xufVxuXG5mdW5jdGlvbiBnZXRIb3Jpem9uSW1hZ2UoKSB7XG4gIGNvbnN0IGhvcml6b25JbWFnZSA9IG5ldyBJbWFnZTtcbiAgaG9yaXpvbkltYWdlLnNyYyA9IGhvcml6b25JbWFnZURhdGFVcmk7XG4gIGhvcml6b25JbWFnZS5oZWlnaHQgPSBIT1JJWk9OX0g7XG4gIGhvcml6b25JbWFnZS53aWR0aCA9IEhPUklaT05fVztcbiAgcmV0dXJuIGhvcml6b25JbWFnZTtcbn1cblxuZnVuY3Rpb24gZ2V0RGlub3NhdXJJbWFnZSgpIHtcbiAgY29uc3QgZGlub0ltYWdlID0gbmV3IEltYWdlO1xuICBkaW5vSW1hZ2Uuc3JjID0gZGlub0ltYWdlRGF0YVVyaTtcbiAgcmV0dXJuIGRpbm9JbWFnZTtcbn1cblxuIiwibW9kdWxlLmV4cG9ydHMgPSAgY2xhc3MgT2JzdGFjbGUge1xuICBjb25zdHJ1Y3Rvcih4LCB5LCB3aWR0aCA9IDIsIGhlaWdodCA9IDQpIHtcbiAgICB0aGlzLnggPSB4O1xuICAgIHRoaXMueSA9IHk7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICB9XG59XG4iLCJjb25zdCBPYnN0YWNsZSA9IHJlcXVpcmUoJy4vb2JzdGFjbGUnKTtcblxubW9kdWxlLmV4cG9ydHMgPSAgY2xhc3MgT2JzdGFjbGVNYW5hZ2Vye1xuICBkZWZhdWx0T2JzdGFjbGVzID0gW107XG5cbiAgY29uc3RydWN0b3IoKXtcbiAgfVxuXG4gIGFkZERlZmF1bHRPYnN0YWNsZShvYnN0YWNsZSl7XG4gICAgdGhpcy5kZWZhdWx0T2JzdGFjbGVzLnB1c2gob2JzdGFjbGUpO1xuICB9XG5cbiAgZ2V0RGVmYXVsdE9ic3RhY2xlcygpe1xuICAgIHJldHVybiB0aGlzLmRlZmF1bHRPYnN0YWNsZXM7XG4gIH1cbn1cbiJdfQ==
